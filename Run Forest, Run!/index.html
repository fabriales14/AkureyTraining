<!DOCTYPE html>
<!--
    All Rights Reserved
    This software is proprietary information of
    Intelligent Sense
    Use is subject to license terms.
    Filename: index.html
    Author: falvarado@akurey.com
-->
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
<!--<![endif]-->

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="description" content="" />

    <meta name="viewport" content="width=device-width" />

    <title>Run Forest, Run!</title>

    <link rel="stylesheet" href="css/normalize.css" />
    <link rel="stylesheet" href="css/style.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/3.0.1/mustache.min.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
        integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">

    <script src="js/vendor/modernizr-2.6.2-respond-1.1.0.min.js"></script>
</head>

<body>
    <!-- build:remove -->
    <span id="browser-sync-binding"></span>
    <!-- endbuild -->
    <header class="header">
        <img class="header__logo" src="images/logo.png">
        <a class="header__icon"><i class="fas fa-bars fa-3x"></i></a>
        <nav class="header__nav">
            <ul class="header__nav__elements">
                <li><a href="#">Directorio de Agentes</a></li>
                <li><a href="#">Contacto</a></li>
                <li><a href="#">Ingresar</a></li>
            </ul>
        </nav>
    </header>

    <div class="search">
    </div>

    <div class="container">
        <div class="container__header">
            <h1 class="container__header__title container__header__title--black">Los Mejores agentes de seguridad</h1>
            <input class="container__header__input" id="search_input" type="search" placeholder="Buscar por Ubicación" onkeypress="handler(event)">
            <button class="container__header__button" onclick="filterCompanies()" ><img src="images/search.png"></button>
        </div>

        <div class="container__body" id="box">
            <script type="mustache/x-tmpl" id="chuckTmpl">
                {{#companies}}
                    <article class="container__body__item">
                        <div class="container__body__item__header">
                            <h1 class="container__body__item__header__title">{{name}}</h1>
                            <img class="container__body__item__header__logo" src="images/certified.png">
                        </div>
                        <div class="container__body__item__line"></div>
                        <section class="container__body__item__section">
                            <img class="container__body__item__section__img" src="images/chuck.jpg">
                            <p class="container__body__item__section__info">{{description}}</p>
                        </section>
                        <footer class="container__body__item__footer">
                            <p class="container__body__item__footer__tittle">Desde ${{rate}} {{hours}}/hrs</p>
                            <button class="container__body__item__footer__button">Contratar</button>
                        </footer>
                    </article>
                {{/companies}}
            </script>
        </div>

        <script>
            var companiesList;
            var tmpl = document.getElementById("chuckTmpl").innerHTML;
            var companiesJSON = new Promise(
                function (resolve, reject) {
                    var xhhtp = new XMLHttpRequest();
                    xhhtp.onreadystatechange = function () {
                        if (this.readyState == 4 && this.status == 200) {
                            resolve(xhhtp.response);
                        }
                    };
                    xhhtp.open("GET", "https://api.myjson.com/bins/uptto", true);
                    xhhtp.send();
                }
            )
            var getCompanies = function () {
                companiesJSON.then(function (companies) {
                    companiesList = JSON.parse(companies)
                    var html = Mustache.to_html(tmpl, JSON.parse(companies));
                    var box = document.getElementById("box");
                    box.innerHTML = html;
                })
            }
            getCompanies();

            function filterCompanies(){
                pName = document.getElementById("search_input").value;
                comp = { "companies": []};
                comp.companies = companiesList.companies.filter( elem => elem.name.includes(pName));
                var html = Mustache.to_html(tmpl, comp);
                var box = document.getElementById("box");
                box.innerHTML = html;
            }

            function handler(e){
                if (e.keyCode === 13){
                    filterCompanies();
                }
            }
        </script>
    </div>

    <footer class="footer">
        <p class="footer__header">Desarrollado por Akurey.com</p>
        <p class="footer__text">Todos los derechos reservados.</p>
        <div class="footer__link">
            <a href="">Términos y Condiciones</a>
        </div>
    </footer>

    <script src="js/vendor/jquery-1.10.1.min.js"></script>
    <script src="js/main.js"></script>

    <!-- Live reload option. Remove in production environments -->
    <!-- <script src="//localhost:35729/livereload.js"></script>-->
</body>

</html>